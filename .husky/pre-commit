#!/usr/bin/env bash
. "$(dirname -- "$0")/_/husky.sh"

# Stash un-staged changes to avoid diff noise
STASHED=false
if ! git diff --quiet; then
  git stash push -k -u -q
  STASHED=true
fi

npm run -s verify:api-types || { echo 'API type verification failed'; [ "$STASHED" = true ] && git stash pop -q; exit 1; }

# Restore stashed changes
[ "$STASHED" = true ] && git stash pop -q || true

echo 'API type verification passed.'
